@startuml

[*] --> NEW : SendOrder
NEW --> commit_cycle



state commit_cycle {

	SUBMITTING --> ACTIVE
	ACTIVE --> PARTIALLY_FILLED
	ACTIVE --> FILLED
	PARTIALLY_FILLED--> FILLED

	SUBMITTING --> REJECTED

	FILLED --> [*]
	REJECTED --> [*]
}

SUBMITTING --> cancel_cycle : CancelOrder
ACTIVE --> cancel_cycle : CancelOrder
PARTIALLY_FILLED --> cancel_cycle : CancelOrder

state cancel_cycle {
	[*] --> CANCELLING 

	CANCELLING --> PENDING_CANCELLING
	PENDING_CANCELLING --> CANCELLED
	PENDING_CANCELLING --> PARTIALLY_CANCELLED
	PENDING_CANCELLING --> CANCEL_REJECTED

	CANCELLED --> [*]
	PARTIALLY_CANCELLED --> [*]
	CANCEL_REJECTED --> [*]
}



NEW : 待报
NEW : created and waiting to deal

SUBMITTING : 正报
note left of SUBMITTING : broker has received order \n but hasn't gotten receipt from exchange

ACTIVE : 已报
ACTIVE : broker has received confirm from exchange

PARTIALLY_FILLED : 部成
PARTIALLY_FILLED : part of the order has matched

FILLED : 已成
FILLED : the order has holly matched

REJECTED : 废单
REJECTED : 交易所认为委托无效

CANCELLING : 待撤
CANCELLING : 下单撤单指令，还未开始处理

PENDING_CANCELLING : 正撤
PENDING_CANCELLING : 已经提交撤单指令到订单处理系统，未确认是否下单成功

PARTIALLY_CANCELLED : 部撤
PARTIALLY_CANCELLED : 下单指令中的一部份数量已被撤消

CANCELLED : 已撤
CANCELLED : 委托指令全部被撤消

CANCEL_REJECTED : 撤废
CANCEL_REJECTED : 撤单废单，表示撤单指令失败

UNKNOWN : 未知

@enduml