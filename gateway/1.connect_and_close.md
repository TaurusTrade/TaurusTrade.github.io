# 连接/登录和关闭

连接成功后，通过context 注册 Exchange 和 Board



## vnpy

```
def connect(self, setting: dict)
def close(self)

```

## 金证



```
[函数原型] 
/**
* 初始化插件(无config.ini)
* @param[in] pInitInfo 操作员用户名密码
* @param[in] tagKcbpConfig KCBP通讯设置
* @param[in] nThreads 线程池的线程数
* @param[in] pszLogName  日志文件前缀   ///< 新增
* @param[in] pszAlgoName  需要授权码的产品名称
* @param[in] bLogOpenFlag 普通信息是否写入日志文件
* @return 初始化插件成功或失败
*/
    int InitPlugin(PST_tagInitInfo pInitInfo, ST_tagKCBP_CONFIG &tagKcbpConfig, int nThreads = 1, char *pszLogName = "", char *pszAlgoName = OEM_PRODUCT_NAME, BOOL bLogOpenFlag = FALSE);
[参数] 
参数	参数含义	参数说明	参数类型	是否必填
pInitInfo	操作员名及密码设置	注1	输入参数	是
tagKcbpConfig	KCBP通讯设置	注2	输入参数	是
nThreads	请求处理线程数	任意数字	输入参数	是 
pszLogName	日志文件前缀	任意字符串	输入参数	是
pszAlgoName	需要授权码的产品名称	授权产品名称	输入参数	是
bLogOpenFlag	普通信息是否写入日志文件	true或false	输入参数	是
      
注1：操作员名及密码设置结构体定义
结构体成员	含义	说明	是否必填
szUserName	操作员名		是
szPassword	操作员密码		是
bBackAllHQ	行情返回方式	True:定时返回所有的行情；
false:仅返回改变的行情	否

注2：KCBP通讯设置结构体定义
结构体成员	含义	说明	是否必填
szUserName	用户名	KCBP用户名	是
szPassword	密码	KCBP用户密码	是
szIPAddress	IP地址	KCBP的IP地址	是
szServer	服务器名	KCBP服务器名	是
nPort	端口	KCXP端口	是
szReq	请求队列	KCXP请求队列名	是
szAns	应答队列	KCXP应答队列名	是

[返回值]
0表示成功，非0表示失败

[示例]
 ST_tagInitInfo stInitInfo = {0};
	strcpy_s(stInitInfo.szUserName, m_csUserName.GetBuffer());
	strcpy_s(stInitInfo.szPassword, m_csPassword.GetBuffer());

	ST_tagKCBP_CONFIG tagKcbpConfig = {0};
	memcpy(tagKcbpConfig.szUserName,"KCXP00", 7);
	memcpy(tagKcbpConfig.szPassword,"888888", 7);
	memcpy(tagKcbpConfig.szIPAddress,"192.168.50.31", 14);
	memcpy(tagKcbpConfig.szServer,"KCBP1", 6);
	memcpy(tagKcbpConfig.szReq,"req_market", 11);
	memcpy(tagKcbpConfig.szAns,"ans_market", 11);
	tagKcbpConfig.nPort = 21000;
  	m_pLBMPlugin->InitPlugin(&stInitInfo,tagKcbpConfig,5,"算法Api","提速版",TRUE);


```

## 根网
```
# 连接服务器
    tradeServer = CtsServer()
    connInfo = tradeServer.connect(serverHost, serverPort)
    printObject(connInfo, '系统连接：')
    
    # 柜员登录
    optLoign = tradeServer.optLogin(optId, optPw)
    printObject(optLoign, '柜员登录：')
```

## 恒生

```
功能号	10001	老功能号		更新日期	20190529
功能名称	登录	版本号	20140617	结果集返回	Y
英文名	func_am_user_login			请求类型	请求
业务范围	账户			功能状态	公开
功能描述	建立与投资管理系统的连接，UFX系统中做其他操作前必须先进行登陆。				
输入参数	参数名	类型	说明	必须	备注
	operator_no	C16	操作员编号	Y	投资系统操作员编号，要求在投资系统的登陆模式或该操作员的登陆模式为操作员编号登陆。
	password	C16	操作员密码	Y	
	mac_address	C20	登录机器MAC地址	Y	
	ip_address	C15	登录机器IP地址	Y	
	hd_volserial	C128	登录机器硬盘序列号	N	
	op_station	C256	登录站点	Y	
	terminal_info	C256	终端信息	N	"现货终端信息采集时需传入该字段，传入时请按以下格式传入：cpuid;内网ip;手机号;手机设备号;计算机名;磁盘信息（盘符，格式化方式，盘符总大小，卷标序列号）;客户端版本号;操作系统版本号;公司名称;外网IP地址;PC终端序列号;PC生产厂商;PC产品型号;IP2;MAC2;[站点名称]IP:Port
示例：BFEBFBFF000406X4;192.168.xxx.xx;;;MYCOMPUTER;C,NTFS,99,32F03533;O32-ZGV201901.02.000;MICROSOFT WINDOWS 10 专业版;总公司;192.168.xxx.xx;3V8XFCX;DELL INC.;LATITUDE E7470;;;[cyy直连]192.168.xx.xx 15827"
	authorization_id	C64	开发者授权编号	Y	联系恒生获取。（注：现已经接入的系统请于2014年12月31号前获取授权并完成程序更新。联系方式：o3kffb@hundsun.com）
	app_id	C32	客户端ID	N	仅对期货终端信息采集有效
	authorize_code	C16	终端授权码	N	仅对期货终端信息采集有效
	port_id	N8	接入端口	N	仅对期货终端信息采集有效，接入程序的tcp端口
输入参数2	参数名	类型	说明	必须	备注
	counter_id	C3	柜台编号	N	1:CTP柜台;2：恒生柜台;3:金仕达柜台;4:飞马柜台。仅对期货终端信息采集有效，如果有多个柜台，每个柜台的信息都必传采集，支持批量传入。
	terminal_no	C1024	交易终端信息	N	仅对期货终端信息采集有效
	data_scale	C1024	客户端系统信息采集完整度	N	仅对恒生柜台有效，仅对期货终端信息采集有效
	service_errcode	C8	终端信息错误号	N	仅对期货终端信息采集有效，如果调用柜台的动态库采集报错，请传入错误号
输出参数	参数名	类型	说明	操作符	备注
	user_token	C512	令牌号		"登陆返回令牌号，该令牌号表示用户身份，其他所有接口调用都需要该令牌，该令牌无操作情况下五分钟过期。特别注意，解析输出字段必须根据字段的名称进行解析，不能根据字段的顺序进行解析。
"
	version_no	C32	版本号		UFX版本号

```