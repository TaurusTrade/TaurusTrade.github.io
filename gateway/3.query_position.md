## vnpy: 异步
```    
    def query_position(self)
```

## 金证



```
获取持仓及当日汇总 
[函数原型]
/**
* 取操作员的持仓
* @param[in] nAssetID 资产单元ID(0-表示当前用户的所有资产单元)
* @param[in] bZero 是否返回持仓为0的记录
* @return return 0: 成功，其它：错误码
*/
  int GetShare(int nAssetID, BOOL bZero, char * pStkCode);
[参数]
参数  参数含义  参数说明  参数类型  是否必填
nAssetID  资产单元ID    输入参数  是
bZero 是否返回持仓为0的记录   输入参数  是
pCode 股票代码  ''查全部 输入参数  是

[返回值]
0表示成功，非0表示失败
[示例]
m_pLBMPlugin->GetShare(1,FALSE,＂＂);

调用前需设置持仓回调函数，才能在回调函数中获取异步请求返回的数据，函数原型：
/**
* 设置持仓回调函数
* @param[in] hWnd句柄
* @param[in] pShareFun 持仓回调函数
*/
  void SetCallBackShare(HWND hWnd, CALLBACK_SHARE pShareFun);
[参数]
参数  参数含义  参数说明  参数类型  是否必填
hWnd  窗口句柄    输入参数  是
pShareFun 持仓回调函数    输入参数  是
[返回值]
无
[示例]
m_pLBMPlugin->SetCallBackShare(this->GetSafeHwnd(), OnShare);

/** 资产单元持仓查询结果 */
struct ASSET_SHARE
{
  int nProjectId;              //!< 项目ID
  char szProjectName[64 + 1];  //!< 项目名称
  int nAssetId;                //!< 资产单元ID
  char szAssetName[64 + 1];    //!< 资产单元名称
  int nCombiId;                //!< 组合ID
  short siIntOrg;              //!< 内部机构
  char chStkex[1 + 1];         //!< 证券交易所
  char szStkbd[2 + 1];         //!< 交易板块
  char szStkpbu[8 + 1];        //!< 交易单元
  char szTrdacct[10 + 1];      //!< 交易账户
  char chCurrency[1 + 1];      //!< 货币代码
  char szStkCode[8 + 1];       //!< 证券代码
  char szStkName[16 + 1];      //!< 证券名称
  char chStkCls[1 + 1];        //!< 证券类别
  long llStkPrebln;            //!< 证券昨日余额
  long llStkBln;               //!< 证券余额
  long llStkAvl;               //!< 证券可用数量
  long llStkFrz;               //!< 证券冻结数量
  long llStkUfz;               //!< 证券解冻数量
  long llStkNtrd;              //!< 证券非流通数量
  long llStkTrdFrz;            //!< 证券交易冻结数量
  long llStkTrdUfz;            //!< 证券交易解冻数量
  long llStkTrdOtd;            //!< 证券交易在途数量
  long llStkTrdBln;            //!< 证券交易轧差数量
  double dStkBcost;            //!< 证券买入成本
  double dStkBcostRlt;         //!< 证券买入成本（实时）
  double dStkIncome;           //!< 今日实际盈亏金额
  double dStkIncomePre;        //!< 昨日实际盈亏金额
  double dStkFpl;              //!< 今日浮动盈亏金额
  double dStkFplPre;           //!< 昨日浮动盈亏金额
  double dStkMktl;             //!< 今日盯市盈亏金额
  double dStkMktlPre;          //!< 昨日盯市盈亏金额
  double dMktVal;              //!< 市值
};

```


```
6.2 查询持仓、盈亏、当日汇总(资产单元资产)


[函数原型]
/**
  *证券信息查询
  * @param[in] szCodes 证券代码集合，以"|"隔开 430002|430002,最大支持20只股票
  * @param[out] stStkAssetShare 证券资产信息
  * @param[out] iCount 查询到证券数量
  * @return 调用LBM成功或失败
  */时
  int GetStkAssetShare(const char* szCodes, STK_ASSET_SHARE_S* pstStkAssetShare, int* iCount); [参数]
参数  参数含义  参数说明  参数类型  是否必填
szCodes 证券代码集合  以"|"隔开 430002|430002,最大支持20只股票  输入参数  是
pstStkAssetShare  证券资产信息    输出参数  是
iCount  查询到证券数量   输出参数  是

[返回值]
0表示成功，非0表示失败
[示例]  
  int iRet = m_pLBM->GetStkAssetShare(szStkCode, &stStkInfo, &iCount);
  if (iRet != RTMSG_OK)
  {
    str = m_pLBM->GetLastError(1);
AfxMessageBox(str);
}



struct STK_ASSET_SHARE_S
{
  int iIntOrg;                                 //内部机构
  int iAssetId;                              //资产单元
  char szTrdacct[LEN_TRDACCT];               //证券账号
  char szStkCode[LEN_STK_CODE];              //证券代码
  char chStkCls;                             //证券类型
  char szStkName[LEN_STK_NAME];              //证券名称
  long long llStkVol;                        //T + 0可用股票量(余额 + 交易轧差)
  double dStkBcostPre;                       //期初成本
  double dStkBcostRlt;                       //当前成本
  double dStkFloatIncome;                    //买卖盈亏(浮动盈亏)
  double dStkIncome;                         //实现收益(今日实际盈亏)
  double dTotalIncome;                       //总盈亏
  double dMktVal;                            //证券市值
  long long llStkAvl;                        //当前数量(可用)
  long long llTodayBidVol;                   //当日买入数量
  long long llTodayAskVol;                   //当日卖出数量
  double dTodayBidAmt;                       //当日买入金额
  double dTodayAskAmt;                       //当日卖出金额
  double dTodayBidCost;                      //当日买费用
  double dTodayAskCost;                      //当日卖费用
  long long llStkBidVol;                     //买挂单数量
  long long llStkAskVol;                     //卖挂单数量
};


```
